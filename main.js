var ee,C,De,Nt,F,Se,Re,Te,Ie,_e,ce,le,Pt,Y={},Z=[],Mt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,te=Array.isArray;function O(t,e){for(var n in e)t[n]=e[n];return t}function fe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function L(t,e,n){var i,o,r,s={};for(r in e)r=="key"?i=e[r]:r=="ref"?o=e[r]:s[r]=e[r];if(arguments.length>2&&(s.children=arguments.length>3?ee.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)s[r]===void 0&&(s[r]=t.defaultProps[r]);return V(t,s,i,o,null)}function V(t,e,n,i,o){var r={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++De,__i:-1,__u:0};return o==null&&C.vnode!=null&&C.vnode(r),r}function T(t){return t.children}function Q(t,e){this.props=t,this.context=e}function G(t,e){if(e==null)return t.__?G(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?G(t):null}function Dt(t){if(t.__P&&t.__d){var e=t.__v,n=e.__e,i=[],o=[],r=O({},e);r.__v=e.__v+1,C.vnode&&C.vnode(r),he(t.__P,r,e,t.__n,t.__P.namespaceURI,32&e.__u?[n]:null,i,n??G(e),!!(32&e.__u),o),r.__v=e.__v,r.__.__k[r.__i]=r,je(i,r,o),e.__e=e.__=null,r.__e!=n&&We(r)}}function We(t){if((t=t.__)!=null&&t.__c!=null)return t.__e=t.__c.base=null,t.__k.some(function(e){if(e!=null&&e.__e!=null)return t.__e=t.__c.base=e.__e}),We(t)}function Ne(t){(!t.__d&&(t.__d=!0)&&F.push(t)&&!X.__r++||Se!=C.debounceRendering)&&((Se=C.debounceRendering)||Re)(X)}function X(){for(var t,e=1;F.length;)F.length>e&&F.sort(Te),t=F.shift(),e=F.length,Dt(t);X.__r=0}function Ee(t,e,n,i,o,r,s,c,u,l,_){var a,h,f,v,k,x,y,g=i&&i.__k||Z,b=e.length;for(u=Rt(n,e,g,u,b),a=0;a<b;a++)(f=n.__k[a])!=null&&(h=f.__i!=-1&&g[f.__i]||Y,f.__i=a,x=he(t,f,h,o,r,s,c,u,l,_),v=f.__e,f.ref&&h.ref!=f.ref&&(h.ref&&pe(h.ref,null,f),_.push(f.ref,f.__c||v,f)),k==null&&v!=null&&(k=v),(y=!!(4&f.__u))||h.__k===f.__k?u=Ae(f,u,t,y):typeof f.type=="function"&&x!==void 0?u=x:v&&(u=v.nextSibling),f.__u&=-7);return n.__e=k,u}function Rt(t,e,n,i,o){var r,s,c,u,l,_=n.length,a=_,h=0;for(t.__k=new Array(o),r=0;r<o;r++)(s=e[r])!=null&&typeof s!="boolean"&&typeof s!="function"?(typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?s=t.__k[r]=V(null,s,null,null,null):te(s)?s=t.__k[r]=V(T,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?s=t.__k[r]=V(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):t.__k[r]=s,u=r+h,s.__=t,s.__b=t.__b+1,c=null,(l=s.__i=Tt(s,n,u,a))!=-1&&(a--,(c=n[l])&&(c.__u|=2)),c==null||c.__v==null?(l==-1&&(o>_?h--:o<_&&h++),typeof s.type!="function"&&(s.__u|=4)):l!=u&&(l==u-1?h--:l==u+1?h++:(l>u?h--:h++,s.__u|=4))):t.__k[r]=null;if(a)for(r=0;r<_;r++)(c=n[r])!=null&&(2&c.__u)==0&&(c.__e==i&&(i=G(c)),He(c,c));return i}function Ae(t,e,n,i){var o,r;if(typeof t.type=="function"){for(o=t.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=t,e=Ae(o[r],e,n,i));return e}t.__e!=e&&(i&&(e&&t.type&&!e.parentNode&&(e=G(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Tt(t,e,n,i){var o,r,s,c=t.key,u=t.type,l=e[n],_=l!=null&&(2&l.__u)==0;if(l===null&&c==null||_&&c==l.key&&u==l.type)return n;if(i>(_?1:0)){for(o=n-1,r=n+1;o>=0||r<e.length;)if((l=e[s=o>=0?o--:r++])!=null&&(2&l.__u)==0&&c==l.key&&u==l.type)return s}return-1}function Pe(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Mt.test(e)?n:n+"px"}function J(t,e,n,i,o){var r,s;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof i=="string"&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||Pe(t.style,e,"");if(n)for(e in n)i&&n[e]==i[e]||Pe(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(Ie,"$1")),s=e.toLowerCase(),e=s in t||e=="onFocusOut"||e=="onFocusIn"?s.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?i?n.u=i.u:(n.u=_e,t.addEventListener(e,r?le:ce,r)):t.removeEventListener(e,r?le:ce,r);else{if(o=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Me(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=_e++;else if(e.t<n.u)return;return n(C.event?C.event(e):e)}}}function he(t,e,n,i,o,r,s,c,u,l){var _,a,h,f,v,k,x,y,g,b,D,j,U,I,K,R=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(u=!!(32&n.__u),r=[c=e.__e=n.__e]),(_=C.__b)&&_(e);e:if(typeof R=="function")try{if(y=e.props,g="prototype"in R&&R.prototype.render,b=(_=R.contextType)&&i[_.__c],D=_?b?b.props.value:_.__:i,n.__c?x=(a=e.__c=n.__c).__=a.__E:(g?e.__c=a=new R(y,D):(e.__c=a=new Q(y,D),a.constructor=R,a.render=Wt),b&&b.sub(a),a.state||(a.state={}),a.__n=i,h=a.__d=!0,a.__h=[],a._sb=[]),g&&a.__s==null&&(a.__s=a.state),g&&R.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=O({},a.__s)),O(a.__s,R.getDerivedStateFromProps(y,a.__s))),f=a.props,v=a.state,a.__v=e,h)g&&R.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),g&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(g&&R.getDerivedStateFromProps==null&&y!==f&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(y,D),e.__v==n.__v||!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(y,a.__s,D)===!1){e.__v!=n.__v&&(a.props=y,a.state=a.__s,a.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(H){H&&(H.__=e)}),Z.push.apply(a.__h,a._sb),a._sb=[],a.__h.length&&s.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(y,a.__s,D),g&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(f,v,k)})}if(a.context=D,a.props=y,a.__P=t,a.__e=!1,j=C.__r,U=0,g)a.state=a.__s,a.__d=!1,j&&j(e),_=a.render(a.props,a.state,a.context),Z.push.apply(a.__h,a._sb),a._sb=[];else do a.__d=!1,j&&j(e),_=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++U<25);a.state=a.__s,a.getChildContext!=null&&(i=O(O({},i),a.getChildContext())),g&&!h&&a.getSnapshotBeforeUpdate!=null&&(k=a.getSnapshotBeforeUpdate(f,v)),I=_!=null&&_.type===T&&_.key==null?Oe(_.props.children):_,c=Ee(t,te(I)?I:[I],e,n,i,o,r,s,c,u,l),a.base=e.__e,e.__u&=-161,a.__h.length&&s.push(a),x&&(a.__E=a.__=null)}catch(H){if(e.__v=null,u||r!=null)if(H.then){for(e.__u|=u?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;r[r.indexOf(c)]=null,e.__e=c}else{for(K=r.length;K--;)fe(r[K]);ue(e)}else e.__e=n.__e,e.__k=n.__k,H.then||ue(e);C.__e(H,e,n)}else r==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):c=e.__e=It(n.__e,e,n,i,o,r,s,u,l);return(_=C.diffed)&&_(e),128&e.__u?void 0:c}function ue(t){t&&(t.__c&&(t.__c.__e=!0),t.__k&&t.__k.some(ue))}function je(t,e,n){for(var i=0;i<n.length;i++)pe(n[i],n[++i],n[++i]);C.__c&&C.__c(e,t),t.some(function(o){try{t=o.__h,o.__h=[],t.some(function(r){r.call(o)})}catch(r){C.__e(r,o.__v)}})}function Oe(t){return typeof t!="object"||t==null||t.__b>0?t:te(t)?t.map(Oe):O({},t)}function It(t,e,n,i,o,r,s,c,u){var l,_,a,h,f,v,k,x=n.props||Y,y=e.props,g=e.type;if(g=="svg"?o="http://www.w3.org/2000/svg":g=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),r!=null){for(l=0;l<r.length;l++)if((f=r[l])&&"setAttribute"in f==!!g&&(g?f.localName==g:f.nodeType==3)){t=f,r[l]=null;break}}if(t==null){if(g==null)return document.createTextNode(y);t=document.createElementNS(o,g,y.is&&y),c&&(C.__m&&C.__m(e,r),c=!1),r=null}if(g==null)x===y||c&&t.data==y||(t.data=y);else{if(r=r&&ee.call(t.childNodes),!c&&r!=null)for(x={},l=0;l<t.attributes.length;l++)x[(f=t.attributes[l]).name]=f.value;for(l in x)f=x[l],l=="dangerouslySetInnerHTML"?a=f:l=="children"||l in y||l=="value"&&"defaultValue"in y||l=="checked"&&"defaultChecked"in y||J(t,l,null,f,o);for(l in y)f=y[l],l=="children"?h=f:l=="dangerouslySetInnerHTML"?_=f:l=="value"?v=f:l=="checked"?k=f:c&&typeof f!="function"||x[l]===f||J(t,l,f,x[l],o);if(_)c||a&&(_.__html==a.__html||_.__html==t.innerHTML)||(t.innerHTML=_.__html),e.__k=[];else if(a&&(t.innerHTML=""),Ee(e.type=="template"?t.content:t,te(h)?h:[h],e,n,i,g=="foreignObject"?"http://www.w3.org/1999/xhtml":o,r,s,r?r[0]:n.__k&&G(n,0),c,u),r!=null)for(l=r.length;l--;)fe(r[l]);c||(l="value",g=="progress"&&v==null?t.removeAttribute("value"):v!=null&&(v!==t[l]||g=="progress"&&!v||g=="option"&&v!=x[l])&&J(t,l,v,x[l],o),l="checked",k!=null&&k!=t[l]&&J(t,l,k,x[l],o))}return t}function pe(t,e,n){try{if(typeof t=="function"){var i=typeof t.__u=="function";i&&t.__u(),i&&e==null||(t.__u=t(e))}else t.current=e}catch(o){C.__e(o,n)}}function He(t,e,n){var i,o;if(C.unmount&&C.unmount(t),(i=t.ref)&&(i.current&&i.current!=t.__e||pe(i,null,e)),(i=t.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){C.__e(r,e)}i.base=i.__P=null}if(i=t.__k)for(o=0;o<i.length;o++)i[o]&&He(i[o],e,n||typeof t.type!="function");n||fe(t.__e),t.__c=t.__=t.__e=void 0}function Wt(t,e,n){return this.constructor(t,n)}function $e(t,e,n){var i,o,r,s;e==document&&(e=document.documentElement),C.__&&C.__(t,e),o=(i=typeof n=="function")?null:n&&n.__k||e.__k,r=[],s=[],he(e,t=(!i&&n||e).__k=L(T,null,[t]),o||Y,Y,e.namespaceURI,!i&&n?[n]:o?null:e.firstChild?ee.call(e.childNodes):null,r,!i&&n?n:o?o.__e:e.firstChild,i,s),je(r,t,s)}ee=Z.slice,C={__e:function(t,e,n,i){for(var o,r,s;e=e.__;)if((o=e.__c)&&!o.__)try{if((r=o.constructor)&&r.getDerivedStateFromError!=null&&(o.setState(r.getDerivedStateFromError(t)),s=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(t,i||{}),s=o.__d),s)return o.__E=o}catch(c){t=c}throw t}},De=0,Nt=function(t){return t!=null&&t.constructor===void 0},Q.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=O({},this.state),typeof t=="function"&&(t=t(O({},n),this.props)),t&&O(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Ne(this))},Q.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ne(this))},Q.prototype.render=T,F=[],Re=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Te=function(t,e){return t.__v.__b-e.__v.__b},X.__r=0,Ie=/(PointerCapture)$|Capture$/i,_e=0,ce=Me(!1),le=Me(!0),Pt=0;var Et=0,_n=Array.isArray;function p(t,e,n,i,o,r){e||(e={});var s,c,u=e;if("ref"in u)for(c in u={},e)c=="ref"?s=e[c]:u[c]=e[c];var l={type:t,props:u,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Et,__i:-1,__u:0,__source:o,__self:r};if(typeof t=="function"&&(s=t.defaultProps))for(c in s)u[c]===void 0&&(u[c]=s[c]);return C.vnode&&C.vnode(l),l}var re,S,de,Ue,ie=0,Je=[],N=C,Fe=N.__b,Ge=N.__r,Le=N.diffed,Ke=N.__c,qe=N.unmount,Be=N.__;function Ve(t,e){N.__h&&N.__h(S,t,ie||e),ie=0;var n=S.__H||(S.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function M(t){return ie=1,At(Ye,t)}function At(t,e,n){var i=Ve(re++,2);if(i.t=t,!i.__c&&(i.__=[n?n(e):Ye(void 0,e),function(c){var u=i.__N?i.__N[0]:i.__[0],l=i.t(u,c);u!==l&&(i.__N=[l,i.__[1]],i.__c.setState({}))}],i.__c=S,!S.__f)){var o=function(c,u,l){if(!i.__c.__H)return!0;var _=i.__c.__H.__.filter(function(h){return h.__c});if(_.every(function(h){return!h.__N}))return!r||r.call(this,c,u,l);var a=i.__c.props!==c;return _.some(function(h){if(h.__N){var f=h.__[0];h.__=h.__N,h.__N=void 0,f!==h.__[0]&&(a=!0)}}),r&&r.call(this,c,u,l)||a};S.__f=!0;var r=S.shouldComponentUpdate,s=S.componentWillUpdate;S.componentWillUpdate=function(c,u,l){if(this.__e){var _=r;r=void 0,o(c,u,l),r=_}s&&s.call(this,c,u,l)},S.shouldComponentUpdate=o}return i.__N||i.__}function Qe(t){return ie=5,jt(function(){return{current:t}},[])}function jt(t,e){var n=Ve(re++,7);return $t(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Ot(){for(var t;t=Je.shift();){var e=t.__H;if(t.__P&&e)try{e.__h.some(ne),e.__h.some(me),e.__h=[]}catch(n){e.__h=[],N.__e(n,t.__v)}}}N.__b=function(t){S=null,Fe&&Fe(t)},N.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Be&&Be(t,e)},N.__r=function(t){Ge&&Ge(t),re=0;var e=(S=t.__c).__H;e&&(de===S?(e.__h=[],S.__h=[],e.__.some(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.some(ne),e.__h.some(me),e.__h=[],re=0)),de=S},N.diffed=function(t){Le&&Le(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Je.push(e)!==1&&Ue===N.requestAnimationFrame||((Ue=N.requestAnimationFrame)||Ht)(Ot)),e.__H.__.some(function(n){n.u&&(n.__H=n.u),n.u=void 0})),de=S=null},N.__c=function(t,e){e.some(function(n){try{n.__h.some(ne),n.__h=n.__h.filter(function(i){return!i.__||me(i)})}catch(i){e.some(function(o){o.__h&&(o.__h=[])}),e=[],N.__e(i,n.__v)}}),Ke&&Ke(t,e)},N.unmount=function(t){qe&&qe(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.some(function(i){try{ne(i)}catch(o){e=o}}),n.__H=void 0,e&&N.__e(e,n.__v))};var ze=typeof requestAnimationFrame=="function";function Ht(t){var e,n=function(){clearTimeout(i),ze&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,35);ze&&(e=requestAnimationFrame(n))}function ne(t){var e=S,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),S=e}function me(t){var e=S;t.__c=t.__(),S=e}function $t(t,e){return!t||t.length!==e.length||e.some(function(n,i){return n!==t[i]})}function Ye(t,e){return typeof e=="function"?e(t):e}var Ut=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Ze=new Set(Ut);function Ft(t){let e={};for(let n in t){let i=n.replace(/[A-Z]/g,o=>`-${o.toLowerCase()}`);e[i]=t[n]}return e}var ge=class{uid=0;constructor(e){e&&(this.uid=e)}next(){return++this.uid}},Gt=new ge;function z(){return`styled-component-${Gt.next()}`}function Xe(t){let e=document.styleSheets;for(let n of e)for(let i of n.cssRules)if(i.cssText.includes(`.${t} `))return!0;return!1}function ye(t,e){if(!Xe(t)){let n=document.createElement("style");n.innerHTML=`.${t} { ${e} }`,document.head.appendChild(n)}}function Lt(t,e){if(!Xe(t)){let n=document.createElement("style");n.innerHTML=`.${t} ${e}`,document.head.appendChild(n)}}function Kt(t,e){let n=JSON.stringify(Ft(e),null,2);n=n.replaceAll(",",";"),n=n.replaceAll('"',"");let i=z();return Object.assign(r=>{let{children:s,...c}=r;Lt(i,n);let l={className:r.className||i,...c};return L(t,l,s)},{className:i})}function qt(t,e,...n){let i=z();return Object.assign(r=>{let{children:s,...c}=r,u="",l=n.length;e.forEach((h,f)=>{f<l?u+=h+n[f]:u+=h}),ye(i,u);let a={className:r.className?.toString()||i,...c};return L(t,a,s)},{className:i})}function Bt(t){return t.length==0?!0:typeof t[0]!="function"}function zt(t,e,...n){if(Bt(n))return qt(t,e,...n);let i=Object.assign(o=>{let r="",s=n.length;e.forEach((a,h)=>{h<s?r+=a+n[h](o):r+=a});let{children:c,...u}=o,l=i.mappedId.get(o);l||(l=z(),ye(l,r),i.mappedId.set(o,l));let _={className:o.className||l,...u};return L(t,_,c)},{mappedId:new Map});return i}function Jt(t){return(e,...n)=>{let i="",o=n.length;e.forEach((c,u)=>{u<o?i+=c+n[u]:i+=c});let r=z();return t.className&&(r=`${t.className} ${r}`),Object.assign(c=>{let{children:u,...l}=c;ye(r,i);let a={className:c.className?.toString()||r,...l};return L(t,a,u)},{className:r})}}var et=Jt;Ze.forEach(t=>{et[t]=function(e,...n){return Array.isArray(e)&&"raw"in e?zt(t,e,...n):Kt(t,e)}});var tt=et;var q=class{keys;_groupName;_baseCSS="";maps=new Map;constructor(e){this.keys=e;for(let n in e)this.maps.set(n,"");this._groupName=z()}initBaseCSS(e){let n=e.join(" ");this._baseCSS=n}init(e){for(let n in this.keys){let i=e(n);this.maps.set(n,i)}}setCSS(e){return(n,...i)=>{let o="",r=i.length;n.forEach((s,c)=>{c<r?o+=s+i[c]:o+=s}),this.maps.set(e,o)}}get groupName(){return this._groupName}generate(){let e=`.${this._groupName} { ${this._baseCSS} }
`;this.keys.forEach((i,o)=>{let r=`.${this._groupName}[${i}]`;e+=`${r} { ${this.maps.get(i)} }
`});let n=document.createElement("style");n.innerHTML=e,document.head.appendChild(n)}};var B=class{keys;_mainKey;maps=new Map;constructor(e,n){this.keys=e,this._mainKey=n;for(let i in e)this.maps.set(i,"")}init(e){for(let n in this.keys){let i=e(n);this.maps.set(n,i)}}setCSS(e){return(n,...i)=>{let o="",r=i.length;n.forEach((s,c)=>{c<r?o+=s+i[c]:o+=s}),this.maps.set(e,o)}}get mainKey(){return this._mainKey}generate(){let e={},n="";this.keys.forEach((o,r)=>{e[o]=o;let s=`.${e[o]}`;o!=this.mainKey&&(s=`.${this.mainKey}.${o}`),n+=`${s} { ${this.maps.get(o)} }
`});let i=document.createElement("style");return i.innerHTML=n,document.head.appendChild(i),e}};var ve=tt;var nt={right:[0,-1,0,-1,2,2,0,-1,0],left:[0,-1,0,3,2,-2,0,-1,0],sauna:[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],relief:[1,1,1,1,1,-1,-1,-1,-1]};function rt(t){let e=[];for(let n of t.fonts){let i=n;n.includes(" ")&&(i=`"${n}"`),e.push(i)}return e.join(",")}var oe=t=>t>=0?t<=255?t:255:0,it=t=>t>=-128?t<=127?t:127:-128,Vt=(t,e,n)=>{let i=Math.floor(t*.299+e*.587+n*.114),o=Math.floor(t*-.168736+e*-.331264+n*.5+128),r=Math.floor(t*.5+e*-.418688+n*-.081312+128);return[i,o,r]},Qt=(t,e,n)=>{let i,o,r;return i=t+1.4075*(n-128),o=t-.3455*(e-128)-.7169*(n-128),r=t+1.779*(e-128),i=Math.floor(i),o=Math.floor(o),r=Math.floor(r),i=i<0?0:i,i=i>255?255:i,o=o<0?0:o,o=o>255?255:o,r=r<0?0:r,r=r>255?255:r,[i,o,r]},Yt=(t,e)=>{let n=Math.round(Math.sqrt(e.length)),i=Math.floor(n/2),o=t.data,r=t.width,s=t.height,c=new ImageData(r,s),u=c.data;for(let l=0;l<s;l++)for(let _=0;_<r;_++){let a=0,h=0,f=0;for(let k=0;k<n;k++)for(let x=0;x<n;x++){let y=Math.min(s-1,Math.max(0,l+k-i)),g=Math.min(r-1,Math.max(0,_+x-i)),b=(y*r+g)*4,D=e[k*n+x];a+=o[b]*D,h+=o[b+1]*D,f+=o[b+2]*D}let v=(l*r+_)*4;u[v]=a,u[v+1]=h,u[v+2]=f,u[v+3]=255}return c};function Zt(t){return t.usePop?Math.pow(t.popDim,2):t.greenTimes}var ot=(t,e)=>Math.round(Math.random()*(e-t)+t);function Xt(t){return JSON.parse(JSON.stringify(t))}var se=class{img;imgOutput;imgOutputPop;running=!1;canvas;ctx;popCanvas;popCtx;config;_previewWidth;currentTime=0;randRange=(e,n)=>Math.round(Math.random()*(n-e)+e);randName=e=>{let n=`-_+~!^&\u3001.\u3002\u201D\u201C"'|`[this.randRange(0,14)];return e[this.randRange(0,e.length-1)].replace(/\d\d\d\d/,()=>this.randRange(0,9999).toString()).replace(/_/g,()=>n)};constructor(e,n){this.config=e||xe,this.img=n||new Image,this.imgOutput=new Image,this.imgOutputPop=new Image,this.canvas=document.createElement("canvas"),this.popCanvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.popCtx=this.popCanvas.getContext("2d"),this._previewWidth=this.config.previewWidth}get isRunning(){return this.running}get previewWidth(){return this._previewWidth||this.srcWidth}get isPop(){return this.getConfigKey("usePop")}get useWaterMark(){return this.getConfigKey("watermark")}get isGreen(){return this.getConfigKey("isGreen")}get popDim(){return this.getConfigKey("popDim")}get quality(){return this.getConfigKey("quality")}get greenTimes(){return this.getConfigKey("greenTimes")}get greenStep(){return this.getConfigKey("greenStep")}get userNames(){return this.getConfigKey("userNames")}get randEnabled(){return this.getConfigKey("rand")}async setIsRand(e){await this.setConfigKey("rand",e)}async setUserNames(e){await this.setConfigKey("userNames",e)}async setGreenTimes(e){await this.setConfigKey("greenTimes",e)}async setGreenStep(e){await this.setConfigKey("greenStep",e)}async setPopDim(e){await this.setConfigKey("popDim",e)}async setQualty(e){await this.setConfigKey("quality",e)}async setIsPop(e){await this.setConfigKey("usePop",e)}async setIsGreen(e){await this.setConfigKey("isGreen",e)}async setUseWaterMark(e){await this.setConfigKey("watermark",e)}async setConfigKey(e,n){let i=Xt(this.config);i[e]=n,await this.setConfig(i)}getConfigKey(e){return this.config[e]}setConfig(e){return new Promise((n,i)=>{if(JSON.stringify(e)===JSON.stringify(this.config)){n();return}let o=()=>this.running?!1:(this.config=e,n(),!0);o()||setTimeout(o,100)})}get outputImg(){return this.imgOutput}get outputUrl(){return this.config.usePop?this.imgOutputPop.src:this.imgOutput.src}get srcUrl(){return this.srcImg.src}get srcWidth(){return Math.min(this.config.maxWidth,this.srcImg.naturalWidth)}get srcImg(){return this.img}set srcImg(e){this.img=e}setImageSrc(e){this.img.src=e}drawMix(e,n){let i=this.config.mix,{width:o,height:r}=e,{width:s,height:c}=n;if(i===1)this.ctx.drawImage(this.img,0,0,s,c,0,0,o,r);else{let u=o/i,l=r/i;this.ctx.drawImage(this.img,0,0,s,c,(o-u)/2,(r-l)/2,u,l),this.ctx.drawImage(this.canvas,(o-u)/2,(r-l)/2,u,l,0,0,o,r)}}drawGreenBase({width:e,height:n}){let i=this.ctx.getImageData(0,0,e,n),o=i.data;for(let r=0;r<o.length/4;++r){let s=o[r*4],c=o[r*4+1],u=o[r*4+2],l=oe(77*s+150*c+29*u>>8),_=it((-43*s-85*c+128*u>>8)-1),a=it((128*s-107*c-21*u>>8)-1);o[r*4]=oe(65536*l+91881*a>>16),o[r*4+1]=oe(65536*l-22553*_-46802*a>>16),o[r*4+2]=oe(65536*l+116130*_>>16)}this.ctx.putImageData(i,0,0)}drawOthers({width:e,height:n}){let i=this.config,o=this.ctx.getImageData(0,0,e,n),r=o.data;for(let s=0;s<r.length;s+=4){let c=Vt(r[s],r[s+1],r[s+2]);r[s]=c[0],r[s+1]=c[1],r[s+2]=c[2]}if(i.lightNoise){let s=i.lightNoise/2;for(let c=0;c<r.length;c+=4)r[c]=r[c]+(this.randRange(0,i.lightNoise)-s)}if(i.darkNoise){let s=i.darkNoise/2;for(let c=0;c<r.length;c+=4)r[c]=r[c]+(this.randRange(0,i.darkNoise)-s)*(255-r[c])/255}if(i.contrast&&i.contrast!=1)for(let s=0;s<r.length;s+=4)r[s]=(r[s]-128)*i.contrast+128;if(i.light&&i.light!=0)for(let s=0;s<r.length;s+=4)r[s]=r[s]+i.light*128;i.convoluteName&&(o=Yt(o,nt[i.convoluteName]),r=o.data);for(let s=0;s<r.length;s+=4){if(i.isGreen){let u=i.greenStep*4;r[s]-=u*i.gy,r[s+1]-=u,r[s+2]-=u}let c=Qt(r[s],r[s+1],r[s+2]);r[s]=c[0],r[s+1]=c[1],r[s+2]=c[2]}this.ctx.putImageData(o,0,0)}getWatermarkPlan({width:e,height:n},i,o=ot(0,2)){switch(o%3){case 0:return{align:"right",left:e-i*1.2+this.randRange(-5,5),top:n-i+this.randRange(-5,5)};case 1:return{align:"center",left:e/2+this.randRange(-10,10),top:n-i*1.2+this.randRange(-5,5)};case 2:return{align:"left",left:e/2+this.randRange(-10,10),top:n/2+i+this.randRange(-10,10)}}return{align:"center",left:e/2+this.randRange(-10,10),top:n/2+i+this.randRange(-10,10)}}drawWaterMark({width:e,height:n}){let i=this.config,r=22+this.randRange(0,7);r=e/r*i.watermarkSize,this.ctx.shadowColor=`rgba(0, 0, 0, ${i.watermarkShadowAlpha})`,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=1,this.ctx.shadowBlur=4;let s=rt(this.config);this.ctx.font=`${r}px/400 ${s}`,this.ctx.fillStyle="#fff";let c=r/2,u=this.getWatermarkPlan({width:e,height:n},c,ot(0,this.config.watermarkPlan));this.ctx.textAlign=u.align,this.ctx.textBaseline="bottom",this.ctx.fillText("@"+this.randName(i.userNames),u.left,u.top)}patina(e){let n=Zt(this.config);return new Promise((i,o)=>{(()=>{let s=this.config,c=this.img;if(this.running){i(!1);return}this.running=!0;let u=c.naturalWidth,l=c.naturalHeight,_=u,a=l;s.rand?this.randRange=(f,v)=>Math.round(Math.random()*(v-f)+f):this.randRange=()=>0;let h=u/l;s.preview&&(h>1?u>s.maxWidth&&(_=s.maxWidth,a=s.maxWidth/h):l>s.maxWidth&&(_=s.maxWidth*h,a=s.maxWidth)),_=Math.floor(_/100*s.zoom),a=Math.floor(a/100*s.zoom),this.canvas.width=_,this.canvas.height=a,requestAnimationFrame(f=>{this.ctx.rect(0,0,_,a),this.ctx.fillStyle="#FFF",this.ctx.fill(),this.drawMix({width:_,height:a},{width:u,height:l}),(s.lightNoise||s.darkNoise||s.contrast!==1||s.light!==0||s.greenStep!==0||s.convoluteName)&&this.drawOthers({width:_,height:a});let v=this.config.usePop,k=_*this.config.popDim,x=a*this.config.popDim;if(v){if(this.config.popDim&&_<this.config.maxWidth){let b=this.config.maxWidth*2;k>b&&(k=b,x=b*a/_)}let g=4e3;k>g&&(k=g,x=g*a/_),this.popCanvas.width=k,this.popCanvas.height=x}let y=()=>{this.currentTime++,s.watermark&&this.drawWaterMark({width:_,height:a}),s.isGreen&&this.drawGreenBase({width:_,height:a});let g=this.popCanvas.toDataURL("image/jpeg",s.quality/100+Math.random()*.05),b=this.canvas.toDataURL("image/jpeg",s.quality/100+Math.random()*.1);this.imgOutput.onload=D=>{let U=this.randRange(-2,2),I=this.randRange(-2,2);this.ctx.rect(0,0,_,a),this.ctx.fillStyle="#FFF",this.ctx.fill(),this.ctx.drawImage(this.imgOutput,0,0,_,a,0-U/2,0-I/2,_+U,a+I),v&&this.popCtx.drawImage(this.imgOutput,(this.currentTime-1)%this.config.popDim*k/this.config.popDim,Math.floor((this.currentTime-1)/this.config.popDim)*x/this.config.popDim,k/this.config.popDim,x/this.config.popDim),e&&e(this),this.currentTime<=n?y():(this.running=!1,this.currentTime=0,e&&e(this),i(!0))},this.imgOutput.src=b,this.imgOutputPop.src=g};y()})})()})}},xe={rand:!0,preview:!0,previewWidth:400,maxWidth:500,zoom:100,mix:1,watermark:!0,watermarkSize:2,watermarkShadowAlpha:.5,watermarkPlan:2,userNames:["JohnDoe","JaneDoe"],lightNoise:5,darkNoise:5,contrast:.5,light:.5,isGreen:!0,greenStep:.5,gy:.5,convoluteName:"sauna",greenTimes:10,usePop:!0,popDim:4,quality:80,fonts:["PingFang SC","Microsoft YaHei","sans-serif"]};var en=["ctrl-box"],st=new B(en,"ctrl-box");st.setCSS("ctrl-box")`
  padding: 10px 15px
`;var we=st.generate();function at({children:t}){return p("div",{className:we["ctrl-box"],children:t})}var tn=['data-running="true"'],Ce=new q(tn);Ce.setCSS('data-running="true"')`
  cursor: wait;
  ${we["ctrl-box"]} {
    pointer-events: none
  }
`;Ce.generate();var nn=Ce.groupName;function ct({children:t,dataRunning:e}){return p("div",{className:nn,"data-running":e,children:t})}function ke(){try{return JSON.parse(document.cookie)}catch{return{}}}function lt(t={}){let e=xe,n=t||ke();return n.green!=null&&(e.isGreen=n.green),n.greenStep!=null&&(e.greenStep=n.greenStep/2),n.yearsAgo!=null&&(e.greenTimes=n.yearsAgo),n.waterMark!=null&&(e.watermark=n.waterMark),n.usePop!=null&&(e.usePop=n.usePop),n.useRand!=null&&(e.rand=n.useRand),n.popDim!=null&&(e.popDim=n.popDim),n.quality!=null&&(e.quality=n.quality),n.userNames!=null&&(e.userNames=n.userNames),e}function A(t){document.cookie=JSON.stringify(t)}var rn=ve.div`
  overflow: hidden;
  img {
    display: block;
    object-fit: contain;
  }
  @media (min-width: 820px) {
    img {
      float: left;
      width: 50%;
      max-width: 500px;
      max-height: 500px;
    }
  }
  @media (max-width: 820px) {
    img {
      margin: 0 auto;
    }
    .source-image {
      display: none;
    }
  }
`,be=ve.div`
  padding: 4px 0px;
`,ut=document.getElementById("mount"),_t=/^image\/(.+)$/,on=(t,e)=>{let n=new FileReader;n.onload=()=>{let i=n.result;typeof i=="string"&&e(i)},n.readAsDataURL(t)},P=ke(),m=new se(lt(P));m.setImageSrc("./static/images/totoro-avatar.jpg");var ht=document.createElement("form"),$=document.createElement("input");$.type="file";$.accept="image/*";ht.appendChild($);function ft(){return`[lab.magiconch.com][\u7535\u5B50\u5305\u6D46]-${+Date.now()}.jpg`}function sn(){let t=Qe(m.srcImg),[e,n]=M(m.srcUrl),[i,o]=M(ft()),[r,s]=M(m.isRunning),[c,u]=M(m.outputUrl),[l,_]=M(m.srcWidth),[a,h]=M(m.isGreen),[f,v]=M(m.greenStep*2),[k,x]=M(m.isPop),[y,g]=M(m.useWaterMark),[b,D]=M(m.greenTimes),[j,U]=M(m.popDim),[I,K]=M(m.quality),[R,H]=M(m.userNames.join(`
`)),[pt,dt]=M(m.randEnabled),W=async()=>{await m.patina(w=>{_(m.previewWidth),u(w.outputUrl),s(w.isRunning)})},ae=w=>{on(w,d=>{m.setImageSrc(d),n(m.srcImg.src),_(m.previewWidth),u(m.outputUrl)})};document.addEventListener("paste",w=>{let d=w.clipboardData;if(d?.items[0]){let E=d.items[0].getAsFile();E&&_t.test(E.type)&&ae(E)}}),document.addEventListener("dragover",w=>{w.preventDefault()}),document.addEventListener("drop",w=>{w.preventDefault();let d=w.dataTransfer;if(d?.items[0]){let E=d.items[0].getAsFile();E&&_t.test(E.type)&&ae(E)}});let mt=w=>{ht.reset(),$.onchange=()=>{!$.files||!$.files[0]||ae($.files[0])},$.click()},gt=async w=>{if(m.isRunning)return;let d=w.currentTarget.checked;m.setIsGreen(d),h(d),P.green=d,A(P),await W()},yt=async w=>{let d=w.currentTarget.checked;m.setUseWaterMark(d),P.waterMark=d,A(P),g(d),await W()},vt=async w=>{if(m.isRunning)return;let d=parseInt(w.currentTarget.value);m.setGreenTimes(d),P.yearsAgo=d,A(P),D(d),await W()},xt=async w=>{if(m.isRunning)return;let d=parseInt(w.currentTarget.value);m.setPopDim(d),P.popDim=d,A(P),U(d),await W()},wt=async w=>{if(m.isRunning)return;let d=parseInt(w.currentTarget.value);m.setGreenStep(d/2),P.greenStep=d,A(P),v(d),await W()},Ct=async w=>{if(m.isRunning)return;let d=parseInt(w.currentTarget.value);m.setQualty(d),P.quality=d,A(P),K(d),await W()},kt=async w=>{if(m.isRunning)return;let d=w.currentTarget.checked;m.setIsPop(d),x(d),P.usePop=d,A(P),await W()},bt=async w=>{if(m.isRunning)return;let d=w.currentTarget.checked;m.setIsRand(d),dt(d),P.usePop=d,A(P),await W()},St=w=>{let d=w.currentTarget.value,E=d.split(`
`);m.setUserNames(E),H(d),P.userNames=E,A(P)};return p(ct,{dataRunning:r,children:[p("header",{children:[p("h1",{children:"Patina, Pictures from ancient time"}),p("p",{children:"Make the emoticons have a vintage look"})]}),p(rn,{children:[p("img",{className:"source-image",src:e,ref:t,width:l,onLoad:W}),p("img",{src:c,width:l})]}),p(at,{children:[p(be,{children:[p("button",{type:"submit",onClick:mt,children:"Choose or paste picture here"}),p("a",{className:"btn",href:c,download:i,onClick:()=>{o(ft())},children:"Download"})]}),p(be,{children:[p("label",{children:[p("input",{type:"checkbox",checked:a,onChange:gt}),"Green"]}),p("label",{children:[p("input",{type:"checkbox",checked:y,onChange:yt}),"WaterMark"]}),p("label",{children:[p("input",{type:"checkbox",checked:k,onChange:kt}),"Pop"]}),y&&p(T,{children:p("label",{children:[p("input",{type:"checkbox",checked:pt,onChange:bt}),"Rand"]})})]}),p(be,{children:[!k&&a&&p(T,{children:[p("h4",{children:"YearsAgo"}),p("input",{type:"range",min:1,max:100,step:1,value:b,onChange:vt}),b]}),k&&p(T,{children:[p("h4",{children:"PopDIm"}),p("input",{type:"range",min:1,max:10,step:1,value:j,onChange:xt}),j]}),a&&p(T,{children:[p("h4",{children:"Green Step"}),p("input",{type:"range",min:0,max:50,step:1,value:f,onChange:wt}),f/2]}),p("h4",{children:"Quality"}),p("input",{type:"range",min:1,max:100,step:1,value:I,onChange:Ct}),I,y&&p(T,{children:[p("h4",{children:"WaterMarks"}),p("textarea",{value:R,cols:30,rows:10,onChange:St}),p("button",{type:"button",onClick:W,children:"Reload"})]})]})]})]})}function an(){return p(sn,{})}ut&&$e(p(an,{}),ut);
/*!
 * Patina.ts
 * @itorr <https://lab.magiconch.com/>
 * 2022-03-31
 */
